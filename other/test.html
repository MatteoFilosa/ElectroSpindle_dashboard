<!doctype html>
<html>

<head>
    <!---Bootstrap-->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <!--D3.js-->
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <title>Single spindle visualization</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/style_single.css">
    </link>
    <body>
<div id="tooltip"></div>
        <div class="container" id="svg-div">
            <div class="row" id="svg-row">
                <!--
            <div class="col-sm">
              One of three columns
            </div>
            -->
        
            </div>
        </div>

    <script>    
    var dataset = [[1,5],[4,6],[2,3],[5,6],[7,8],[4,12]]

    let zoom = d3.zoom()
            .on('zoom', handleZoom);

        function handleZoom(e) {

           
            var array = d3.selectAll("g")._groups[0]
                //var gPath = d3.selectAll("g").pop()
            console.log(array[array.length-1])

            var my_g = array[array.length - 1]

            d3.select(my_g).attr("id", function (d, i) { return "my_g_id" })

            d3.select("#my_g_id").attr("transform", "scale(1.2)")

            console.log(e)
            //console.log(lastElement);
                //console.log(gPath)

              
        }

        function initZoom() {
            d3.select('svg')
                .call(zoom);
        }

    function displayTooltip(d, i, event) {
            document.getElementById("tooltip").style.visibility = "visible"

            var tooltip = document.getElementById("tooltip")
            tooltip.innerHTML = d[1]
            tooltip.style.position = "absolute"
            tooltip.style.top = (event.screenY - 80) + "px"
            tooltip.style.left = (event.screenX - 80) + "px"


        }

        function hideTooltip(d, i, event) {

            document.getElementById("tooltip").style.visibility = "hidden"

        }

        


                       document.getElementById("svg-div").innerHTML += '<div class="col-sm"><svg width="800" height="510" id="svg1" ></svg></div>'
                        var svg_to_select = "#svg1"

                        var width = 500, height = 400

                        var new_svg = d3.select(svg_to_select),
                            margin = 200,
                            width = new_svg.attr("width") - margin, //300
                            height = new_svg.attr("height") - margin //200
                            





                        var g = new_svg.append("g")
                            .attr("transform", "translate(" + 100 + "," + 100 + ")")
                            .attr("id", function (d, i) { return "g1" })


                        new_svg.append('text')
                            .attr('x', width / 2 + 100)
                            .attr('y', 80)
                            .attr('text-anchor', 'middle')
                            .style('font-family', 'Helvetica')
                            .style('font-size', 20)
                            .text(" Chart");

                        // X label
                        new_svg.append('text')
                            .attr('x', width / 2 + 100)
                            .attr('y', height - 15 + 150)
                            .attr('text-anchor', 'middle')
                            .style('font-family', 'Helvetica')
                            .style('font-size', 12)
                            .text("Time");

                        // Y label
                        new_svg.append('text')
                            .attr('text-anchor', 'middle')
                            .attr('transform', 'translate(40,' + height + ')rotate(-90)')
                            .style('font-family', 'Helvetica')
                            .style('font-size', 12)
                            .text("Test");

                        var xScale = d3.scaleLinear().domain([0, 10]).range([0, width]),
                            yScale = d3.scaleLinear().domain([0, 50]).range([height, 0]);

                        g.append("g")
                            .attr("transform", "translate(0," + height + ")")
                            .attr("id", function (d, i) { return "xAxis" })
                            .call(d3.axisBottom(xScale));

                        g.append("g")
                            .attr("id", function (d, i) { return "yAxis" })
                            .call(d3.axisLeft(yScale));



                        // Step 7
                        new_svg.append('g')
                            .selectAll("dot")
                            .data(dataset)
                            .enter()
                            .append("circle")
                            .attr("cx", function (d) { return xScale(d[0]); })
                            .attr("cy", function (d) { return yScale(d[1]); })
                            .attr("r", 3)
                            .attr("transform", "translate(" + 100 + "," + 100 + ")")
                            .style("fill", "#CC0000")
                            .attr("id", function (d, i) { return "dot"})
                            .attr("class", "punto")
                            .on("mouseover", function (d, i) {
                                displayTooltip(d, i, event)
                            })
                            .on("mouseout", function (d, i) { hideTooltip() })



                        // Step 8        

                        var line = d3.line()
                            .x(function (d) { return xScale(d[0]); })
                            .y(function (d) { return yScale(d[1]); })
                            .curve(d3.curveMonotoneX)

                        new_svg.append("path")
                            .datum(dataset)
                            .attr("class", "line")
                            .attr("transform", "translate(" + 100 + "," + 100 + ")")
                            .attr("d", line)
                            .style("fill", "none")
                            .style("stroke", "#CC0000")
                            .style("stroke-width", "2")
                            .attr("id", function (d, i) { return "path"})


                            var array = d3.selectAll("g")._groups[0]
                                //var gPath = d3.selectAll("g").pop()

                                var my_g = array[array.length - 1]

                                d3.select(my_g).attr("id", function (d, i) { return "my_g_id" })

                                new_svg.call(d3.zoom().on("zoom", function () {
                                    d3.select("#path").attr("transform", d3.event.transform)
                                    d3.select(my_g).attr("transform", d3.event.transform)

                                }))


                        document.getElementById("svg-div").innerHTML += '<div class="col-sm"><svg width="800" height="510" id="svg2" style = "position:absolute; margin-left: 200px;"></svg></div>'
                            var svg_to_select = "#svg2"

                            var width = 500, height = 400

                            var new_svg2 = d3.select(svg_to_select),
                                margin = 200,
                                width = new_svg.attr("width") - margin, //300
                                height = new_svg.attr("height") - margin //200






                            var g = new_svg2.append("g")
                                .attr("transform", "translate(" + 100 + "," + 100 + ")")
                                .attr("id", function (d, i) { return "g2" })


                            new_svg2.append('text')
                                .attr('x', width / 2 + 100)
                                .attr('y', 80)
                                .attr('text-anchor', 'middle')
                                .style('font-family', 'Helvetica')
                                .style('font-size', 20)
                                .text(" Chart2");

                            // X label
                            new_svg2.append('text')
                                .attr('x', width / 2 + 100)
                                .attr('y', height - 15 + 150)
                                .attr('text-anchor', 'middle')
                                .style('font-family', 'Helvetica')
                                .style('font-size', 12)
                                .text("Time2");

                            // Y label
                            new_svg2.append('text')
                                .attr('text-anchor', 'middle')
                                .attr('transform', 'translate(40,' + height + ')rotate(-90)')
                                .style('font-family', 'Helvetica')
                                .style('font-size', 12)
                                .text("Test2");

                            var xScale = d3.scaleLinear().domain([0, 10]).range([0, width]),
                                yScale = d3.scaleLinear().domain([0, 50]).range([height, 0]);

                            g.append("g")
                                .attr("transform", "translate(0," + height + ")")
                                .attr("id", function (d, i) { return "xAxis" })
                                .call(d3.axisBottom(xScale));

                            g.append("g")
                                .attr("id", function (d, i) { return "yAxis" })
                                .call(d3.axisLeft(yScale));



                            // Step 7
                            new_svg2.append('g')
                                .selectAll("dot")
                                .data(dataset)
                                .enter()
                                .append("circle")
                                .attr("cx", function (d) { return xScale(d[0]); })
                                .attr("cy", function (d) { return yScale(d[1]); })
                                .attr("r", 3)
                                .attr("transform", "translate(" + 100 + "," + 100 + ")")
                                .style("fill", "#CC0000")
                                .attr("id", function (d, i) { return "dot2" })
                                .attr("class", "punto")
                                .on("mouseover", function (d, i) {
                                    displayTooltip(d, i, event)
                                })
                                .on("mouseout", function (d, i) { hideTooltip() })



                            // Step 8        

                            var line = d3.line()
                                .x(function (d) { return xScale(d[0]); })
                                .y(function (d) { return yScale(d[1]); })
                                .curve(d3.curveMonotoneX)

                            new_svg2.append("path")
                                .datum(dataset)
                                .attr("class", "line")
                                .attr("transform", "translate(" + 100 + "," + 100 + ")")
                                .attr("d", line)
                                .style("fill", "none")
                                .style("stroke", "#CC0000")
                                .style("stroke-width", "2")
                                .attr("id", function (d, i) { return "path2" })


                        //initZoom()


                        var array2 = d3.select("#svg2").select("g")._groups[0]
                            //var gPath = d3.selectAll("g").pop()

                            var my_g2 = array2[array2.length - 1]

                            d3.select(my_g2).attr("id", function (d, i) { return "my_g_id2" })

                        new_svg2.call(d3.zoom().on("zoom", function () {
                            d3.select("#path2").attr("transform", d3.event.transform)
                                d3.select(my_g2).attr("transform", d3.event.transform)
                                
                            }))

                    

                        



    </script>
</body>

</html>